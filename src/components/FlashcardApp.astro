---
// FlashcardApp – Dutch vocabulary flashcard practice.
// Multi-select topic grid, simple card-flip review, standalone audio via
// Web Speech API. Designed for Starlight theme using its CSS custom properties.
---

<flashcard-app id="flashcard-app"></flashcard-app>

<script>
/* ------------------------------------------------------------------ */
/*  Standalone audio handler for .dutch-audio-btn anywhere on the page */
/* ------------------------------------------------------------------ */
document.addEventListener("click", (e) => {
  const btn = (e.target as Element).closest?.(".dutch-audio-btn") as HTMLButtonElement | null;
  if (!btn) return;
  const text = btn.dataset.text;
  if (!text) return;
  speechSynthesis.cancel();
  const utter = new SpeechSynthesisUtterance(text);
  utter.lang = "nl-NL";
  utter.rate = 0.9;
  speechSynthesis.speak(utter);
});

/* ------------------------------------------------------------------ */
/*  Types                                                              */
/* ------------------------------------------------------------------ */
interface Word {
  dutch: string;
  english: string;
  ipa: string;
}

interface Topic {
  name: string;
  words: Word[];
}

/* ------------------------------------------------------------------ */
/*  Topic data – 15 topics, 12-15 words each, with IPA                */
/* ------------------------------------------------------------------ */
const TOPICS: Topic[] = [
  {
    name: "Greetings & Basics",
    words: [
      { dutch: "hallo", english: "hello", ipa: "/ˈhɑloː/" },
      { dutch: "goedemorgen", english: "good morning", ipa: "/ˌɣudəˈmɔrɣə(n)/" },
      { dutch: "dag", english: "hello / goodbye", ipa: "/dɑx/" },
      { dutch: "tot ziens", english: "goodbye", ipa: "/tɔt ˈzins/" },
      { dutch: "ja", english: "yes", ipa: "/jaː/" },
      { dutch: "nee", english: "no", ipa: "/neː/" },
      { dutch: "alstublieft", english: "please (formal)", ipa: "/ɑlstyˈblift/" },
      { dutch: "dank u wel", english: "thank you", ipa: "/ˈdɑŋk y ˈʋɛl/" },
      { dutch: "sorry", english: "sorry", ipa: "/ˈsɔri/" },
      { dutch: "pardon", english: "excuse me", ipa: "/pɑrˈdɔn/" },
      { dutch: "hoe gaat het?", english: "how are you?", ipa: "/ˌɦu ˈɣaːt (ɦ)ət/" },
      { dutch: "goed", english: "good / well", ipa: "/ɣut/" },
      { dutch: "welkom", english: "welcome", ipa: "/ˈʋɛlkɔm/" },
      { dutch: "meneer", english: "sir / mister", ipa: "/məˈneːr/" },
      { dutch: "mevrouw", english: "madam / mrs.", ipa: "/məˈvrɑu/" },
    ],
  },
  {
    name: "Numbers",
    words: [
      { dutch: "een", english: "one", ipa: "/eːn/" },
      { dutch: "twee", english: "two", ipa: "/tʋeː/" },
      { dutch: "drie", english: "three", ipa: "/dri/" },
      { dutch: "vier", english: "four", ipa: "/viːr/" },
      { dutch: "vijf", english: "five", ipa: "/vɛif/" },
      { dutch: "zes", english: "six", ipa: "/zɛs/" },
      { dutch: "zeven", english: "seven", ipa: "/ˈzeːvə(n)/" },
      { dutch: "acht", english: "eight", ipa: "/ɑxt/" },
      { dutch: "negen", english: "nine", ipa: "/ˈneːɣə(n)/" },
      { dutch: "tien", english: "ten", ipa: "/tiːn/" },
      { dutch: "twintig", english: "twenty", ipa: "/ˈtʋɪntəx/" },
      { dutch: "dertig", english: "thirty", ipa: "/ˈdɛrtəx/" },
      { dutch: "vijftig", english: "fifty", ipa: "/ˈvɛiftəx/" },
      { dutch: "honderd", english: "hundred", ipa: "/ˈɦɔndərt/" },
      { dutch: "duizend", english: "thousand", ipa: "/ˈdœyzənt/" },
    ],
  },
  {
    name: "Time & Days",
    words: [
      { dutch: "maandag", english: "Monday", ipa: "/ˈmaːndɑx/" },
      { dutch: "dinsdag", english: "Tuesday", ipa: "/ˈdɪnzdɑx/" },
      { dutch: "woensdag", english: "Wednesday", ipa: "/ˈʋunzdɑx/" },
      { dutch: "donderdag", english: "Thursday", ipa: "/ˈdɔndərdɑx/" },
      { dutch: "vrijdag", english: "Friday", ipa: "/ˈvrɛidɑx/" },
      { dutch: "zaterdag", english: "Saturday", ipa: "/ˈzaːtərdɑx/" },
      { dutch: "zondag", english: "Sunday", ipa: "/ˈzɔndɑx/" },
      { dutch: "vandaag", english: "today", ipa: "/vɑnˈdaːx/" },
      { dutch: "morgen", english: "tomorrow", ipa: "/ˈmɔrɣə(n)/" },
      { dutch: "gisteren", english: "yesterday", ipa: "/ˈɣɪstərə(n)/" },
      { dutch: "nu", english: "now", ipa: "/ny/" },
      { dutch: "later", english: "later", ipa: "/ˈlaːtər/" },
      { dutch: "uur", english: "hour", ipa: "/yːr/" },
      { dutch: "minuut", english: "minute", ipa: "/miˈnyt/" },
    ],
  },
  {
    name: "Colors",
    words: [
      { dutch: "rood", english: "red", ipa: "/roːt/" },
      { dutch: "blauw", english: "blue", ipa: "/blɑu/" },
      { dutch: "groen", english: "green", ipa: "/ɣrun/" },
      { dutch: "geel", english: "yellow", ipa: "/ɣeːl/" },
      { dutch: "wit", english: "white", ipa: "/ʋɪt/" },
      { dutch: "zwart", english: "black", ipa: "/zʋɑrt/" },
      { dutch: "oranje", english: "orange", ipa: "/oːˈrɑnjə/" },
      { dutch: "paars", english: "purple", ipa: "/paːrs/" },
      { dutch: "roze", english: "pink", ipa: "/ˈroːzə/" },
      { dutch: "bruin", english: "brown", ipa: "/brœyn/" },
      { dutch: "grijs", english: "grey", ipa: "/ɣrɛis/" },
    ],
  },
  {
    name: "Family",
    words: [
      { dutch: "de vader", english: "the father", ipa: "/də ˈvaːdər/" },
      { dutch: "de moeder", english: "the mother", ipa: "/də ˈmudər/" },
      { dutch: "het kind", english: "the child", ipa: "/hɛt kɪnt/" },
      { dutch: "de broer", english: "the brother", ipa: "/də bruːr/" },
      { dutch: "de zus", english: "the sister", ipa: "/də zʏs/" },
      { dutch: "de opa", english: "the grandfather", ipa: "/də ˈoːpaː/" },
      { dutch: "de oma", english: "the grandmother", ipa: "/də ˈoːmaː/" },
      { dutch: "de vriend", english: "the friend (m)", ipa: "/də vrint/" },
      { dutch: "de vriendin", english: "the friend (f)", ipa: "/də vrinˈdɪn/" },
      { dutch: "de man", english: "the man / husband", ipa: "/də mɑn/" },
      { dutch: "de vrouw", english: "the woman / wife", ipa: "/də vrɑu/" },
      { dutch: "het gezin", english: "the family (nuclear)", ipa: "/hɛt ɣəˈzɪn/" },
    ],
  },
  {
    name: "Food & Drink",
    words: [
      { dutch: "het brood", english: "the bread", ipa: "/hɛt broːt/" },
      { dutch: "de kaas", english: "the cheese", ipa: "/də kaːs/" },
      { dutch: "de melk", english: "the milk", ipa: "/də mɛlk/" },
      { dutch: "het water", english: "the water", ipa: "/hɛt ˈʋaːtər/" },
      { dutch: "de koffie", english: "the coffee", ipa: "/də ˈkɔfi/" },
      { dutch: "de thee", english: "the tea", ipa: "/də teː/" },
      { dutch: "het bier", english: "the beer", ipa: "/hɛt biːr/" },
      { dutch: "de wijn", english: "the wine", ipa: "/də ʋɛin/" },
      { dutch: "de appel", english: "the apple", ipa: "/də ˈɑpəl/" },
      { dutch: "de aardappel", english: "the potato", ipa: "/də ˈaːrdɑpəl/" },
      { dutch: "het vlees", english: "the meat", ipa: "/hɛt vleːs/" },
      { dutch: "de vis", english: "the fish", ipa: "/də vɪs/" },
      { dutch: "de soep", english: "the soup", ipa: "/də sup/" },
      { dutch: "het ei", english: "the egg", ipa: "/hɛt ɛi/" },
    ],
  },
  {
    name: "House & Home",
    words: [
      { dutch: "het huis", english: "the house", ipa: "/hɛt hœys/" },
      { dutch: "de kamer", english: "the room", ipa: "/də ˈkaːmər/" },
      { dutch: "de keuken", english: "the kitchen", ipa: "/də ˈkøːkə(n)/" },
      { dutch: "de badkamer", english: "the bathroom", ipa: "/də ˈbɑtkaːmər/" },
      { dutch: "de slaapkamer", english: "the bedroom", ipa: "/də ˈslaːpkaːmər/" },
      { dutch: "de tuin", english: "the garden", ipa: "/də tœyn/" },
      { dutch: "de deur", english: "the door", ipa: "/də døːr/" },
      { dutch: "het raam", english: "the window", ipa: "/hɛt raːm/" },
      { dutch: "de tafel", english: "the table", ipa: "/də ˈtaːfəl/" },
      { dutch: "de stoel", english: "the chair", ipa: "/də stuːl/" },
      { dutch: "het bed", english: "the bed", ipa: "/hɛt bɛt/" },
    ],
  },
  {
    name: "Travel",
    words: [
      { dutch: "het station", english: "the station", ipa: "/hɛt stɑˈʃɔn/" },
      { dutch: "de trein", english: "the train", ipa: "/də trɛin/" },
      { dutch: "de bus", english: "the bus", ipa: "/də bʏs/" },
      { dutch: "de fiets", english: "the bicycle", ipa: "/də fits/" },
      { dutch: "de auto", english: "the car", ipa: "/də ˈɑutoː/" },
      { dutch: "het vliegtuig", english: "the airplane", ipa: "/hɛt ˈvlixˌtœyɣ/" },
      { dutch: "links", english: "left", ipa: "/lɪŋks/" },
      { dutch: "rechts", english: "right", ipa: "/rɛxts/" },
      { dutch: "rechtdoor", english: "straight ahead", ipa: "/ˈrɛxtdoːr/" },
      { dutch: "de straat", english: "the street", ipa: "/də straːt/" },
      { dutch: "de kaart", english: "the map / card", ipa: "/də kaːrt/" },
    ],
  },
  {
    name: "Shopping",
    words: [
      { dutch: "de winkel", english: "the shop", ipa: "/də ˈʋɪŋkəl/" },
      { dutch: "de supermarkt", english: "the supermarket", ipa: "/də ˈsypərˌmɑrkt/" },
      { dutch: "het geld", english: "the money", ipa: "/hɛt ɣɛlt/" },
      { dutch: "de prijs", english: "the price", ipa: "/də prɛis/" },
      { dutch: "goedkoop", english: "cheap", ipa: "/ˈɣutkoːp/" },
      { dutch: "duur", english: "expensive", ipa: "/dyːr/" },
      { dutch: "de kassa", english: "the cash register", ipa: "/də ˈkɑsaː/" },
      { dutch: "betalen", english: "to pay", ipa: "/bəˈtaːlə(n)/" },
      { dutch: "de korting", english: "the discount", ipa: "/də ˈkɔrtɪŋ/" },
      { dutch: "de tas", english: "the bag", ipa: "/də tɑs/" },
    ],
  },
  {
    name: "Body & Health",
    words: [
      { dutch: "het hoofd", english: "the head", ipa: "/hɛt hoːft/" },
      { dutch: "het hart", english: "the heart", ipa: "/hɛt hɑrt/" },
      { dutch: "de hand", english: "the hand", ipa: "/də hɑnt/" },
      { dutch: "het been", english: "the leg", ipa: "/hɛt beːn/" },
      { dutch: "de buik", english: "the belly", ipa: "/də bœyk/" },
      { dutch: "ziek", english: "sick", ipa: "/zik/" },
      { dutch: "gezond", english: "healthy", ipa: "/ɣəˈzɔnt/" },
      { dutch: "de dokter", english: "the doctor", ipa: "/də ˈdɔktər/" },
      { dutch: "de apotheek", english: "the pharmacy", ipa: "/də aːpoːˈteːk/" },
      { dutch: "het ziekenhuis", english: "the hospital", ipa: "/hɛt ˈzikə(n)ˌhœys/" },
      { dutch: "pijn", english: "pain", ipa: "/pɛin/" },
    ],
  },
  {
    name: "Weather",
    words: [
      { dutch: "de zon", english: "the sun", ipa: "/də zɔn/" },
      { dutch: "de regen", english: "the rain", ipa: "/də ˈreːɣə(n)/" },
      { dutch: "de wind", english: "the wind", ipa: "/də ʋɪnt/" },
      { dutch: "de sneeuw", english: "the snow", ipa: "/də sneːu/" },
      { dutch: "warm", english: "warm", ipa: "/ʋɑrm/" },
      { dutch: "koud", english: "cold", ipa: "/kɑut/" },
      { dutch: "het weer", english: "the weather", ipa: "/hɛt ʋeːr/" },
      { dutch: "de wolk", english: "the cloud", ipa: "/də ʋɔlk/" },
      { dutch: "de temperatuur", english: "the temperature", ipa: "/də tɛmpəraːˈtyːr/" },
      { dutch: "mooi weer", english: "nice weather", ipa: "/moːi ʋeːr/" },
    ],
  },
  {
    name: "Work & School",
    words: [
      { dutch: "het werk", english: "the work", ipa: "/hɛt ʋɛrk/" },
      { dutch: "de school", english: "the school", ipa: "/də sxoːl/" },
      { dutch: "de leraar", english: "the teacher (m)", ipa: "/də ˈleːraːr/" },
      { dutch: "de student", english: "the student", ipa: "/də styˈdɛnt/" },
      { dutch: "het kantoor", english: "the office", ipa: "/hɛt kɑnˈtoːr/" },
      { dutch: "de computer", english: "the computer", ipa: "/də kɔmˈpjuːtər/" },
      { dutch: "de vergadering", english: "the meeting", ipa: "/də vərˈɣaːdərɪŋ/" },
      { dutch: "het huiswerk", english: "the homework", ipa: "/hɛt ˈhœysʋɛrk/" },
    ],
  },
  {
    name: "Common Verbs",
    words: [
      { dutch: "zijn", english: "to be", ipa: "/zɛin/" },
      { dutch: "hebben", english: "to have", ipa: "/ˈhɛbə(n)/" },
      { dutch: "gaan", english: "to go", ipa: "/ɣaːn/" },
      { dutch: "komen", english: "to come", ipa: "/ˈkoːmə(n)/" },
      { dutch: "doen", english: "to do", ipa: "/dun/" },
      { dutch: "zeggen", english: "to say", ipa: "/ˈzɛɣə(n)/" },
      { dutch: "kunnen", english: "to be able to / can", ipa: "/ˈkʏnə(n)/" },
      { dutch: "willen", english: "to want", ipa: "/ˈʋɪlə(n)/" },
      { dutch: "moeten", english: "to have to / must", ipa: "/ˈmutə(n)/" },
      { dutch: "werken", english: "to work", ipa: "/ˈʋɛrkə(n)/" },
      { dutch: "wonen", english: "to live (reside)", ipa: "/ˈʋoːnə(n)/" },
      { dutch: "eten", english: "to eat", ipa: "/ˈeːtə(n)/" },
      { dutch: "drinken", english: "to drink", ipa: "/ˈdrɪŋkə(n)/" },
      { dutch: "spreken", english: "to speak", ipa: "/ˈspreːkə(n)/" },
      { dutch: "lezen", english: "to read", ipa: "/ˈleːzə(n)/" },
      { dutch: "schrijven", english: "to write", ipa: "/ˈsxrɛivə(n)/" },
    ],
  },
  {
    name: "Everyday Phrases",
    words: [
      { dutch: "Ik begrijp het niet", english: "I don't understand", ipa: "/ɪk bəˈɣrɛip hɛt nit/" },
      { dutch: "Kunt u dat herhalen?", english: "Can you repeat that?", ipa: "/kʏnt y dɑt hɛrˈhaːlə(n)/" },
      { dutch: "Spreekt u Engels?", english: "Do you speak English?", ipa: "/spreːkt y ˈɛŋəls/" },
      { dutch: "Hoe zeg je...?", english: "How do you say...?", ipa: "/hu zɛx jə/" },
      { dutch: "Mag ik...?", english: "May I...?", ipa: "/mɑx ɪk/" },
      { dutch: "Ik wil graag...", english: "I would like...", ipa: "/ɪk ʋɪl ɣraːx/" },
      { dutch: "Waar is...?", english: "Where is...?", ipa: "/ʋaːr ɪs/" },
      { dutch: "Hoeveel kost dit?", english: "How much does this cost?", ipa: "/ˈhuvəl kɔst dɪt/" },
    ],
  },
  {
    name: "False Friends",
    words: [
      { dutch: "slim", english: "smart (not slim!)", ipa: "/slɪm/" },
      { dutch: "boos", english: "angry (not boss!)", ipa: "/boːs/" },
      { dutch: "gift", english: "poison (not gift!)", ipa: "/ɣɪft/" },
      { dutch: "glad", english: "slippery (not glad!)", ipa: "/ɣlɑt/" },
      { dutch: "brand", english: "fire (not brand!)", ipa: "/brɑnt/" },
      { dutch: "brief", english: "letter (not brief!)", ipa: "/briːf/" },
      { dutch: "map", english: "folder (not map!)", ipa: "/mɑp/" },
      { dutch: "rok", english: "skirt (not rock!)", ipa: "/rɔk/" },
      { dutch: "room", english: "cream (not room!)", ipa: "/roːm/" },
      { dutch: "angel", english: "sting (not angel!)", ipa: "/ˈɑŋəl/" },
    ],
  },
];

/* ------------------------------------------------------------------ */
/*  Custom Element                                                     */
/* ------------------------------------------------------------------ */
class FlashcardApp extends HTMLElement {
  /* state */
  selectedTopics: Set<number> = new Set();
  cards: Word[] = [];
  order: number[] = [];
  current = 0;
  flipped = false;

  /* speaker icon SVG reused in templates */
  static SPEAKER_SVG = `<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>`;

  connectedCallback() {
    this.renderTopicGrid();
  }

  /* ---- helpers ---- */

  shuffle<T>(arr: T[]): T[] {
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
  }

  escapeAttr(s: string): string {
    return s.replace(/&/g, "&amp;").replace(/"/g, "&quot;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
  }

  /* ---- topic selection screen ---- */

  renderTopicGrid() {
    const totalSelected = [...this.selectedTopics].reduce(
      (sum, i) => sum + TOPICS[i].words.length, 0
    );

    this.innerHTML = `
      <div class="fc-container">
        <h2 class="fc-heading">Choose Topics</h2>
        <p class="fc-subheading">Select one or more topics, then press Start.</p>

        <div class="fc-topic-grid">
          ${TOPICS.map((t, i) => `
            <button class="fc-topic-card ${this.selectedTopics.has(i) ? "fc-topic-selected" : ""}"
                    data-index="${i}" type="button">
              <span class="fc-topic-check">${this.selectedTopics.has(i) ? "&#10003;" : ""}</span>
              <span class="fc-topic-name">${t.name}</span>
              <span class="fc-topic-count">${t.words.length} words</span>
            </button>
          `).join("")}
        </div>

        <div class="fc-actions">
          <button class="fc-btn fc-btn-secondary" id="fc-select-all" type="button">
            ${this.selectedTopics.size === TOPICS.length ? "Deselect All" : "Select All"}
          </button>
          <button class="fc-btn fc-btn-primary" id="fc-start" type="button"
                  ${totalSelected === 0 ? "disabled" : ""}>
            Start (${totalSelected} cards)
          </button>
        </div>
      </div>`;

    /* wire up topic card clicks */
    this.querySelectorAll<HTMLButtonElement>(".fc-topic-card").forEach((btn) => {
      btn.addEventListener("click", () => {
        const idx = Number(btn.dataset.index);
        if (this.selectedTopics.has(idx)) {
          this.selectedTopics.delete(idx);
        } else {
          this.selectedTopics.add(idx);
        }
        this.renderTopicGrid();
      });
    });

    /* select / deselect all */
    this.querySelector("#fc-select-all")!.addEventListener("click", () => {
      if (this.selectedTopics.size === TOPICS.length) {
        this.selectedTopics.clear();
      } else {
        TOPICS.forEach((_, i) => this.selectedTopics.add(i));
      }
      this.renderTopicGrid();
    });

    /* start button */
    this.querySelector("#fc-start")!.addEventListener("click", () => {
      if (totalSelected === 0) return;
      this.startPractice();
    });
  }

  /* ---- practice session ---- */

  startPractice() {
    this.cards = [];
    for (const i of this.selectedTopics) {
      this.cards.push(...TOPICS[i].words);
    }
    this.order = this.shuffle([...Array(this.cards.length).keys()]);
    this.current = 0;
    this.flipped = false;
    this.renderCard();
  }

  renderCard() {
    const total = this.order.length;

    /* finished */
    if (this.current >= total) {
      this.innerHTML = `
        <div class="fc-container fc-center">
          <h2 class="fc-heading">All done!</h2>
          <p class="fc-subheading">You reviewed all ${total} cards.</p>
          <div class="fc-actions">
            <button class="fc-btn fc-btn-secondary" id="fc-back-topics" type="button">Back to Topics</button>
            <button class="fc-btn fc-btn-primary" id="fc-restart" type="button">Restart</button>
          </div>
        </div>`;
      this.querySelector("#fc-back-topics")!.addEventListener("click", () => this.renderTopicGrid());
      this.querySelector("#fc-restart")!.addEventListener("click", () => this.startPractice());
      return;
    }

    const card = this.cards[this.order[this.current]];
    const num = this.current + 1;
    const pct = Math.round((this.current / total) * 100);

    this.innerHTML = `
      <div class="fc-container">
        <div class="fc-toolbar">
          <button class="fc-btn fc-btn-small fc-btn-secondary" id="fc-back-topics" type="button">Back to Topics</button>
          <span class="fc-counter">Card ${num} of ${total}</span>
        </div>

        <div class="fc-progress-bar">
          <div class="fc-progress-fill" style="width:${pct}%"></div>
        </div>

        <div class="fc-card ${this.flipped ? "fc-flipped" : ""}" id="fc-card">
          ${this.flipped ? `
            <div class="fc-card-inner">
              <div class="fc-word">${card.dutch}</div>
              <div class="fc-ipa">${card.ipa}</div>
              <button class="dutch-audio-btn fc-audio-btn" data-text="${this.escapeAttr(card.dutch)}" type="button" aria-label="Listen to pronunciation">
                ${FlashcardApp.SPEAKER_SVG}
              </button>
              <div class="fc-divider"></div>
              <div class="fc-answer">${card.english}</div>
            </div>
          ` : `
            <div class="fc-card-inner">
              <div class="fc-word">${card.dutch}</div>
              <div class="fc-ipa">${card.ipa}</div>
              <button class="dutch-audio-btn fc-audio-btn" data-text="${this.escapeAttr(card.dutch)}" type="button" aria-label="Listen to pronunciation">
                ${FlashcardApp.SPEAKER_SVG}
              </button>
              <div class="fc-hint">Click card to reveal answer</div>
            </div>
          `}
        </div>

        <div class="fc-actions">
          <button class="fc-btn fc-btn-primary fc-btn-next" id="fc-next" type="button"
                  ${!this.flipped ? "disabled" : ""}>Next</button>
        </div>
      </div>`;

    /* flip on card click (but not on audio button) */
    this.querySelector("#fc-card")!.addEventListener("click", (e) => {
      if ((e.target as Element).closest(".dutch-audio-btn")) return;
      if (!this.flipped) {
        this.flipped = true;
        this.renderCard();
      }
    });

    /* next */
    this.querySelector("#fc-next")!.addEventListener("click", () => {
      this.current++;
      this.flipped = false;
      this.renderCard();
    });

    /* back to topics */
    this.querySelector("#fc-back-topics")!.addEventListener("click", () => this.renderTopicGrid());
  }
}

customElements.define("flashcard-app", FlashcardApp);
</script>

<style>
  /* ---- layout ---- */
  .fc-container {
    max-width: 640px;
    margin: 0 auto;
  }
  .fc-center {
    text-align: center;
  }
  .fc-heading {
    font-size: 1.5rem;
    font-weight: 700;
    margin: 0 0 0.25rem;
    color: var(--sl-color-text);
  }
  .fc-subheading {
    margin: 0 0 1.25rem;
    color: var(--sl-color-gray-3);
    font-size: 0.95rem;
  }

  /* ---- topic grid ---- */
  .fc-topic-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    gap: 0.65rem;
    margin-bottom: 1.25rem;
  }
  .fc-topic-card {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: 0.15rem;
    padding: 0.75rem 0.85rem;
    border: 2px solid var(--sl-color-gray-4);
    border-radius: 8px;
    background: none;
    cursor: pointer;
    text-align: left;
    color: var(--sl-color-text);
    transition: border-color 0.15s, background-color 0.15s;
  }
  .fc-topic-card:hover {
    background-color: var(--sl-color-accent-low);
  }
  .fc-topic-card.fc-topic-selected {
    border-color: var(--sl-color-accent);
    background-color: var(--sl-color-accent-low);
  }
  .fc-topic-check {
    position: absolute;
    top: 0.45rem;
    right: 0.6rem;
    font-size: 0.95rem;
    font-weight: 700;
    color: var(--sl-color-accent);
    line-height: 1;
  }
  .fc-topic-name {
    font-weight: 600;
    font-size: 0.95rem;
    line-height: 1.25;
  }
  .fc-topic-count {
    font-size: 0.8rem;
    color: var(--sl-color-gray-3);
  }

  /* ---- actions bar ---- */
  .fc-actions {
    display: flex;
    gap: 0.65rem;
    justify-content: center;
    flex-wrap: wrap;
  }

  /* ---- buttons ---- */
  .fc-btn {
    padding: 0.55rem 1.4rem;
    border-radius: 8px;
    font-size: 0.95rem;
    font-weight: 600;
    cursor: pointer;
    border: 1px solid var(--sl-color-gray-4);
    background: none;
    color: var(--sl-color-text);
    transition: background-color 0.15s, opacity 0.15s;
  }
  .fc-btn:disabled {
    opacity: 0.4;
    cursor: not-allowed;
  }
  .fc-btn-primary {
    background: var(--sl-color-accent);
    color: var(--sl-color-text-invert);
    border-color: transparent;
  }
  .fc-btn-primary:hover:not(:disabled) {
    opacity: 0.88;
  }
  .fc-btn-secondary:hover:not(:disabled) {
    background-color: var(--sl-color-accent-low);
  }
  .fc-btn-small {
    padding: 0.3rem 0.85rem;
    font-size: 0.85rem;
  }
  .fc-btn-next {
    min-width: 120px;
  }

  /* ---- toolbar (back + counter) ---- */
  .fc-toolbar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 0.75rem;
  }
  .fc-counter {
    font-size: 0.9rem;
    color: var(--sl-color-gray-3);
    font-variant-numeric: tabular-nums;
  }

  /* ---- progress bar ---- */
  .fc-progress-bar {
    width: 100%;
    height: 6px;
    border-radius: 3px;
    background: var(--sl-color-gray-4);
    margin-bottom: 1.25rem;
    overflow: hidden;
  }
  .fc-progress-fill {
    height: 100%;
    border-radius: 3px;
    background: var(--sl-color-accent);
    transition: width 0.3s ease;
  }

  /* ---- flashcard ---- */
  .fc-card {
    border: 2px solid var(--sl-color-gray-4);
    border-radius: 12px;
    padding: 2.5rem 1.5rem;
    min-height: 220px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    transition: border-color 0.2s;
    margin-bottom: 1.25rem;
  }
  .fc-card:hover {
    border-color: var(--sl-color-accent);
  }
  .fc-card.fc-flipped {
    cursor: default;
  }
  .fc-card-inner {
    width: 100%;
  }
  .fc-word {
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--sl-color-text);
    margin-bottom: 0.3rem;
  }
  .fc-ipa {
    font-size: 1rem;
    color: var(--sl-color-gray-3);
    margin-bottom: 0.75rem;
  }
  .fc-audio-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.4rem;
    border: 1px solid var(--sl-color-gray-4);
    border-radius: 6px;
    background: none;
    color: var(--sl-color-text);
    cursor: pointer;
    transition: background-color 0.15s;
  }
  .fc-audio-btn:hover {
    background-color: var(--sl-color-accent-low);
  }
  .fc-divider {
    width: 60px;
    height: 1px;
    background: var(--sl-color-gray-4);
    margin: 1rem auto;
  }
  .fc-answer {
    font-size: 1.3rem;
    font-weight: 600;
    color: var(--sl-color-text-accent);
  }
  .fc-hint {
    margin-top: 1rem;
    font-size: 0.82rem;
    color: var(--sl-color-gray-3);
  }
</style>
